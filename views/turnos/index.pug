//- extends ../layout

//- block contenido
//-     style.
//-         body {
//-             background-color: #eef5ff;
//-             font-family: Arial, sans-serif;
//-         }
//-         .center-text {
//-             text-align: center;
//-             margin-bottom: 10px;
//-         }
//-         .page-container {
//-             padding: 20px;
//-         }
//-         .actions i {
//-             font-size: 20px;
//-             cursor: pointer;
//-             margin-right: 10px;
//-         }
//-         .icon-edit {
//-             color: #1e88e5;
//-         }
//-         .icon-delete {
//-             color: #e53935;
//-         }
//-         .icon-reservar {
//-             color: #43a047;
//-         }

//-     .page-container

//-         // ---------------- BOTÓN VOLVER ----------------
//-         .mb-3
//-             a.btn.btn-secondary(href="/agendas") ⬅ Volver a Agendas

//-         // ---------------- NOMBRE DEL MÉDICO ----------------
//-         if turnos && turnos.length > 0
//-             - const medicoNombre = turnos[0].nombre_medico || "Doctor"
//-             - const medicoApellido = turnos[0].apellido_medico || ""
//-             h3.center-text Turnos del Dr/a. #{medicoNombre} #{medicoApellido}
//-         else
//-             h3.center-text Turnos del Doctor

//-         br

//-         // ---------------- MENSAJE ----------------
//-         if mensaje
//-             script.
//-                 Swal.fire({
//-                     title: 'Mensaje',
//-                     text: '#{mensaje}',
//-                     icon: 'success',
//-                     confirmButtonText: 'OK'
//-                 });

//-         // ---------------- FILTRO POR ESTADO ----------------
//-         p Estado
//-         select(name="estado" id="estado" class="form-select small-width mb-3")
//-             option(value="") Todos
//-             option(value="Libre") Libre
//-             option(value="Reservado") Reservado
//-             option(value="Confirmado") Confirmado
//-             option(value="Cancelado") Cancelado
//-             option(value="Ausente") Ausente
//-             option(value="Presente") Presente
//-             option(value="En Consulta") En Consulta
//-             option(value="Atendido") Atendido
//-             option(value="No Disponible") No Disponible  

//-         // ---------------- TABLA DE TURNOS ----------------
//-         table#tablaTurnos.table.table-striped.table-bordered
//-             thead
//-                 tr 
//-                     th Fecha
//-                     th Hora
//-                     th Motivo
//-                     th Estado 
//-                     th Orden
//-                     th Paciente
//-                     th DNI
//-                     th Acciones                
//-             tbody 
//-                 each turno in turnos
//-                     tr(data-estado=turno.estado)
//-                         td= turno.fecha_formateada
//-                         td= `${turno.hora_inicio} hs`
//-                         td= turno.motivo || "Vacío"
//-                         td= turno.estado
//-                         td= turno.orden
//-                         td= turno.paciente_nombre || 'Vacío'
//-                         td= turno.dni || 'Vacío'
//-                         td.actions
//-                             a(href=`/turnos/reservar/${turno.id}`)
//-                                 i.icon-reservar.fa-solid.fa-calendar-check(title="Reservar/Editar")
//-                             //- a(href=`/turnos/edit/${turno.id}`)
//-                             //-     i.icon-edit.fa-solid.fa-pen-to-square(title="Editar")
//-                             i.icon-delete.fa-solid.fa-trash(title="Eliminar", onclick=`confirmDelete(${turno.id})`)

//-     // ---------------- SCRIPTS ----------------
//-     script.
//-         function confirmDelete(id) {
//-             Swal.fire({
//-                 title: '¿Eliminar turno?',
//-                 text: "No podrás revertir esto",
//-                 icon: 'warning',
//-                 showCancelButton: true,
//-                 confirmButtonColor: '#3085d6',
//-                 cancelButtonColor: '#d33',
//-                 confirmButtonText: 'Sí, eliminar'
//-             }).then((result) => {
//-                 if (result.isConfirmed) deleteTurno(id);
//-             });
//-         }

//-         function deleteTurno(id) {
//-             fetch(`/turnos/${id}`, { method: 'DELETE' })
//-                 .then(res => {
//-                     if (!res.ok) throw new Error();
//-                     Swal.fire('Eliminado', 'El turno ha sido eliminado.', 'success')
//-                         .then(() => location.reload());
//-                 })
//-                 .catch(() => Swal.fire('Error', 'Hubo un problema eliminando el turno.', 'error'));
//-         }

//-         document.getElementById("estado").addEventListener("change", function () {
//-             const estado = this.value;
//-             document.querySelectorAll("#tablaTurnos tbody tr").forEach(row => {
//-                 if (!estado || row.dataset.estado === estado)
//-                     row.style.display = "";
//-                 else
//-                     row.style.display = "none";
//-             });
//-         });

//- extends ../layout

//- block contenido
//-     style.
//-         body {
//-             background-color: #eef5ff;
//-             font-family: Arial, sans-serif;
//-         }
//-         .center-text {
//-             text-align: center;
//-             margin-bottom: 20px;
//-             font-size: 28px;
//-             font-weight: bold;
//-         }
//-         .page-container {
//-             padding: 20px;
//-         }
//-         .filter-box {
//-             background: #fff;
//-             padding: 15px;
//-             border-radius: 10px;
//-             margin-bottom: 20px;
//-             box-shadow: 0 2px 4px rgba(0,0,0,0.1);
//-         }
//-         .actions i {
//-             font-size: 20px;
//-             cursor: pointer;
//-             margin-right: 10px;
//-         }
//-         .icon-reservar {
//-             color: #2e7d32;
//-         }
//-         .icon-delete {
//-             color: #c62828;
//-         }

//-         /* Colores por estado */
//-         tr[data-estado="Libre"]     { background-color: #e8f5e9 !important; }
//-         tr[data-estado="Reservado"] { background-color: #fff8e1 !important; }
//-         tr[data-estado="Confirmado"]{ background-color: #e3f2fd !important; }
//-         tr[data-estado="Cancelado"] { background-color: #ffebee !important; }
//-         tr[data-estado="Ausente"]   { background-color: #f3e5f5 !important; }
//-         tr[data-estado="Presente"]  { background-color: #e8eaf6 !important; }
//-         tr[data-estado="En Consulta"] { background-color: #ede7f6 !important; }
//-         tr[data-estado="Atendido"]  { background-color: #e0f7fa !important; }
//-         tr:hover {
//-             filter: brightness(0.95);
//-         }

//-     .page-container

//-         // ---------------- BOTÓN VOLVER ----------------
//-         .mb-3
//-             a.btn.btn-secondary(href="/agendas") ⬅ Volver a Agendas

//-         // ---------------- NOMBRE DEL MÉDICO ----------------
//-         if turnos && turnos.length > 0
//-             - const medicoNombre = turnos[0].nombre_medico || "Doctor"
//-             - const medicoApellido = turnos[0].apellido_medico || ""
//-             h3.center-text Turnos del Dr/a. #{medicoNombre} #{medicoApellido}
//-         else
//-             h3.center-text Turnos del Doctor

//-         // ---------------- FILTRO MEJORADO ----------------
//-         .filter-box
//-             label(for="estado" style="font-weight: bold;") Filtrar por estado
//-             select(name="estado" id="estado" class="form-select mt-2")
//-                 option(value="") Ver todos
//-                 option(value="Libre") Libre
//-                 option(value="Reservado") Reservado
//-                 option(value="Confirmado") Confirmado
//-                 option(value="Cancelado") Cancelado
//-                 option(value="Ausente") Ausente
//-                 option(value="Presente") Presente
//-                 option(value="En Consulta") En Consulta
//-                 option(value="Atendido") Atendido
//-                 option(value="No Disponible") No Disponible  

//-         br

//-         // ---------------- TABLA DE TURNOS ----------------
//-         table#tablaTurnos.table.table-striped.table-bordered.table-hover
//-             thead(class="table-dark")
//-                 tr 
//-                     th Fecha
//-                     th Hora
//-                     th Motivo
//-                     th Estado 
//-                     th Orden
//-                     th Paciente
//-                     th DNI
//-                     th Acciones                
//-             tbody 
//-                 each turno in turnos
//-                     tr(data-estado=turno.estado)
//-                         td= turno.fecha_formateada
//-                         td= `${turno.hora_inicio} hs`
//-                         td= turno.motivo || "Vacío"
//-                         td= turno.estado
//-                         td= turno.orden
//-                         td= turno.paciente_nombre || 'Vacío'
//-                         td= turno.dni || 'Vacío'
//-                         td.actions
//-                             // Botón reservado más claro
//-                             a.btn.btn-sm.btn-success(href=`/turnos/reservar/${turno.id}` title="Reservar o editar turno")
//-                                 i.fa-solid.fa-calendar-check
//-                                 |  Reservar
                            
//-                             // Botón eliminar
//-                             button.btn.btn-sm.btn-danger(title="Eliminar" onclick=`confirmDelete(${turno.id})`)
//-                                 i.fa-solid.fa-trash

//-     // ---------------- SCRIPTS ----------------
//-     script.
//-         function confirmDelete(id) {
//-             Swal.fire({
//-                 title: '¿Eliminar turno?',
//-                 text: "No podrás revertir esto",
//-                 icon: 'warning',
//-                 showCancelButton: true,
//-                 confirmButtonColor: '#3085d6',
//-                 cancelButtonColor: '#d33',
//-                 confirmButtonText: 'Sí, eliminar'
//-             }).then((result) => {
//-                 if (result.isConfirmed) deleteTurno(id);
//-             });
//-         }

//-         function deleteTurno(id) {
//-             fetch(`/turnos/${id}`, { method: 'DELETE' })
//-                 .then(res => {
//-                     if (!res.ok) throw new Error();
//-                     Swal.fire('Eliminado', 'El turno ha sido eliminado.', 'success')
//-                         .then(() => location.reload());
//-                 })
//-                 .catch(() => Swal.fire('Error', 'Hubo un problema eliminando el turno.', 'error'));
//-         }

//-         // Filtro
//-         document.getElementById("estado").addEventListener("change", function () {
//-             const estado = this.value;
//-             document.querySelectorAll("#tablaTurnos tbody tr").forEach(row => {
//-                 if (!estado || row.dataset.estado === estado)
//-                     row.style.display = "";
//-                 else
//-                     row.style.display = "none";
//-             });
//-         });

extends ../layout

block contenido
    style.
        body {
            background-color: #eef5ff;
            font-family: Arial, sans-serif;
        }
        .center-text {
            text-align: center;
            margin-bottom: 20px;
            font-size: 28px;
            font-weight: bold;
        }
        .page-container {
            padding: 20px;
        }
        .filter-box {
            background: #fff;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .actions i {
            font-size: 20px;
            cursor: pointer;
            margin-right: 10px;
        }
        .icon-reservar {
            color: #2e7d32;
        }
        .icon-delete {
            color: #c62828;
        }

        /* ============================
           COLORES POR ESTADO (mejorados)
        ============================ */
        tr[data-estado="Libre"]        { background-color: #d0f8ce !important; }
        tr[data-estado="Reservado"]    { background-color: #fff4c2 !important; }
        tr[data-estado="Confirmado"]   { background-color: #bbe1ff !important; }
        tr[data-estado="Cancelado"]    { background-color: #ffd6d6 !important; }
        tr[data-estado="Ausente"]      { background-color: #e8d3f8 !important; }
        tr[data-estado="Presente"]     { background-color: #d6dbff !important; }
        tr[data-estado="En Consulta"]  { background-color: #e4d7ff !important; }
        tr[data-estado="Atendido"]     { background-color: #c8f3f4 !important; }

        tr:hover {
            filter: brightness(0.95);
        }

    .page-container

        // ---------------- BOTÓN VOLVER ----------------
        .mb-3
            a.btn.btn-secondary(href="/agendas") ⬅ Volver a Agendas

        // ---------------- NOMBRE DEL MÉDICO ----------------
        if turnos && turnos.length > 0
            - const medicoNombre = turnos[0].nombre_medico || "Doctor"
            - const medicoApellido = turnos[0].apellido_medico || ""
            h3.center-text Turnos del Dr/a. #{medicoNombre} #{medicoApellido}
        else
            h3.center-text Turnos del Doctor

        // ---------------- FILTRO MEJORADO ----------------
        .filter-box
            label(for="estado" style="font-weight: bold;") Filtrar por estado
            select(name="estado" id="estado" class="form-select mt-2")
                option(value="") Ver todos
                option(value="Libre") Libre
                option(value="Reservado") Reservado
                option(value="Confirmado") Confirmado
                option(value="Cancelado") Cancelado
                option(value="Ausente") Ausente
                option(value="Presente") Presente
                option(value="En Consulta") En Consulta
                option(value="Atendido") Atendido
                option(value="No Disponible") No Disponible  

        br

        // ---------------- TABLA DE TURNOS ----------------
        table#tablaTurnos.table.table-striped.table-bordered.table-hover
            thead(class="table-dark")
                tr 
                    th Fecha
                    th Hora
                    th Motivo
                    th Estado 
                    th Orden
                    th Paciente
                    th DNI
                    th Acciones                
            tbody 
                each turno in turnos
                    tr(data-estado=turno.estado)
                        td= turno.fecha_formateada
                        td= `${turno.hora_inicio} hs`
                        td= turno.motivo || "Vacío"
                        td= turno.estado
                        td= turno.orden
                        td= turno.paciente_nombre || 'Vacío'
                        td= turno.dni || 'Vacío'
                        td.actions
                            // Botón reservado más claro
                            a.btn.btn-sm.btn-success(href=`/turnos/reservar/${turno.id}` title="Reservar o editar turno")
                                i.fa-solid.fa-calendar-check
                                |  Reservar
                            
                            // Botón eliminar
                            button.btn.btn-sm.btn-danger(title="Eliminar" onclick=`confirmDelete(${turno.id})`)
                                i.fa-solid.fa-trash

    // ---------------- SCRIPTS ----------------
    script.
        function confirmDelete(id) {
            Swal.fire({
                title: '¿Eliminar turno?',
                text: "No podrás revertir esto",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'Sí, eliminar'
            }).then((result) => {
                if (result.isConfirmed) deleteTurno(id);
            });
        }

        function deleteTurno(id) {
            fetch(`/turnos/${id}`, { method: 'DELETE' })
                .then(res => {
                    if (!res.ok) throw new Error();
                    Swal.fire('Eliminado', 'El turno ha sido eliminado.', 'success')
                        .then(() => location.reload());
                })
                .catch(() => Swal.fire('Error', 'Hubo un problema eliminando el turno.', 'error'));
        }

        // Filtro
        document.getElementById("estado").addEventListener("change", function () {
            const estado = this.value;
            document.querySelectorAll("#tablaTurnos tbody tr").forEach(row => {
                if (!estado || row.dataset.estado === estado)
                    row.style.display = "";
                else
                    row.style.display = "none";
            });
        });
